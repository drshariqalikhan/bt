<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>QualityStock Screener</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a1d21">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="QualityStock">

    <!-- PWA Manifest & Icons (assumed to be in the root directory) -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.4/css/bulma.min.css">

    <style>
        /* --- Base Theme --- */
        :root { 
            --dark-bg-1: #1a1d21; 
            --dark-bg-2: #272a2e; 
            --dark-border: #444; 
            --light-text: #f0f0f0; 
            --dim-text: #a0a0a0; 
            --accent-color: #3298dc;
        }
        html { 
            background-color: var(--dark-bg-1); 
            height: 100svh; /* Use small viewport height for better mobile fit */
        }
        body { 
            background-color: var(--dark-bg-1); 
            color: var(--light-text);
            display: flex;
            flex-direction: column;
            height: 100%;
            margin: 0;
        }
        
        /* --- General UI Elements --- */
        .navbar { 
            background-color: var(--dark-bg-2); 
            border-bottom: 1px solid var(--dark-border); 
        }
        .navbar-item, .navbar-link { 
            color: var(--light-text); 
            cursor: pointer; 
        }
        .navbar-burger span {
            background-color: var(--light-text);
        }
        .input, .select select { 
            background-color: var(--dark-bg-1); 
            border-color: var(--dark-border); 
            color: var(--light-text); 
        }
        .input::placeholder { color: var(--dim-text); }
        .label { color: var(--light-text); }

        /* --- Page Layout & iOS Safe Area Handling --- */
        .page {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
        }
        #settingsPage {
            display: none; /* Hidden by default */
        }
        .page-nav {
            /* Add padding to account for the iOS status bar/notch */
            padding-top: env(safe-area-inset-top);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
            flex-shrink: 0; /* Prevent navbar from shrinking */
        }
        .page-content {
            flex-grow: 1; /* Allow content to fill remaining space */
            overflow-y: auto; /* Allow content to scroll if it overflows */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            /* Add padding at the bottom for the iOS home indicator bar */
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* --- Main Page Chart Layout --- */
        #appContainer { 
            display: flex; 
            flex-direction: column; 
            gap: 1rem;
            height: 100%;
            padding: 1rem;
        }
        .chart-placeholder {
            background-color: var(--dark-bg-2);
            border: 1px dashed var(--dark-border);
            border-radius: 6px;
            flex: 1; /* Each chart takes up equal space */
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--dim-text);
            min-height: 200px; /* Ensure visibility on all screen sizes */
        }

        /* --- Settings Page Layout --- */
        .settings-container {
             padding: 1.5rem;
        }
        .settings-field { 
            max-width: 400px; 
            margin-bottom: 1.5rem; 
        }
    </style>
</head>
<body>

    <!-- PAGE 1: MAIN PAGE (CHARTS) -->
    <div id="mainPage" class="page">
        <nav class="navbar page-nav" role="navigation" aria-label="main navigation">
            <div class="navbar-brand">
                <a class="navbar-item has-text-weight-bold" id="qualityScreenButton">Quality Screen</a>
                <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicMenu"><span></span><span></span><span></span></a>
            </div>
            <div id="navbarBasicMenu" class="navbar-menu">
                <div class="navbar-start">
                    <div class="navbar-item">
                        <div class="field is-grouped">
                            <p class="control is-expanded"><input class="input" type="text" id="tickerInput" placeholder="e.g., AAPL.US"></p>
                            <p class="control"><button id="fetchButton" class="button is-info">Fetch</button></p>
                        </div>
                    </div>
                    <a class="navbar-item" id="goToSettingsButton">Settings</a>
                </div>
            </div>
        </nav>

        <main class="page-content">
            <div id="appContainer">
                <div id="priceChartPlaceholder" class="chart-placeholder">
                    <span>Price Chart Area</span>
                </div>
                <div id="macdChartPlaceholder" class="chart-placeholder">
                    <span>MACD Chart Area</span>
                </div>
            </div>
        </main>
    </div>

    <!-- PAGE 2: SETTINGS PAGE -->
    <div id="settingsPage" class="page">
        <nav class="navbar page-nav">
            <div class="navbar-brand">
                <a class="navbar-item" id="backButton">< Back</a>
            </div>
            <div class="navbar-menu is-active">
                <div class="navbar-start">
                    <div class="navbar-item has-text-weight-bold">Settings</div>
                </div>
            </div>
        </nav>

        <main class="page-content">
            <div class="settings-container">
                <h2 class="title is-4 has-text-light">Calculations</h2>
                <div class="field settings-field">
                    <label class="label" for="discountRateInput">Discount Rate (%)</label>
                    <div class="control">
                        <input class="input" type="number" id="discountRateInput" value="9.5" step="0.1">
                    </div>
                </div>
                <div class="field settings-field">
                    <label class="label" for="terminalGrowthInput">Terminal Growth Rate (%)</label>
                    <div class="control">
                        <input class="input" type="number" id="terminalGrowthInput" value="2.5" step="0.1">
                    </div>
                </div>

                <hr style="background-color: var(--dark-border);">

                <h2 class="title is-4 has-text-light">Chart Display</h2>
                <div class="field settings-field">
                    <label class="label" for="timePeriodSelector">Default Time Period</label>
                    <div class="control">
                        <div class="select is-fullwidth">
                            <select id="timePeriodSelector">
                                <option value="all">All Time</option>
                                <option value="10yr">10 Years</option>
                                <option value="5yr" selected>5 Years</option>
                                <option value="1yr">1 Year</option>
                            </select>
                        </div>
                    </div>
                </div>

                <hr style="background-color: var(--dark-border);">
                
                <h2 class="title is-4 has-text-light">App Data</h2>
                <div class="field">
                    <div class="control">
                        <button class="button is-danger" id="deleteDataButton">Clear All Saved Data</button>
                    </div>
                    <p class="help has-text-grey">This will clear the last viewed ticker and any saved settings.</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Element References ---
            const mainPage = document.getElementById('mainPage');
            const settingsPage = document.getElementById('settingsPage');
            const goToSettingsButton = document.getElementById('goToSettingsButton');
            const backButton = document.getElementById('backButton');
            const burger = document.querySelector('.navbar-burger');
            const menu = document.getElementById(burger.dataset.target);
            
            // --- Page Navigation Logic ---
            goToSettingsButton.addEventListener('click', () => {
                mainPage.style.display = 'none';
                settingsPage.style.display = 'flex';
            });

            backButton.addEventListener('click', () => {
                mainPage.style.display = 'flex';
                settingsPage.style.display = 'none';
            });
            
            // --- Mobile Menu (Burger) ---
            burger.addEventListener('click', () => {
                burger.classList.toggle('is-active');
                menu.classList.toggle('is-active');
            });
            
            // --- Placeholder for 'Delete Data' Button ---
            const deleteDataButton = document.getElementById('deleteDataButton');
            deleteDataButton.addEventListener('click', () => {
                if (confirm("Are you sure you want to delete all saved app data?")) {
                    console.log("Data would be cleared here.");
                    alert("App data has been cleared.");
                }
            });

            // --- Placeholder for 'Fetch' Button ---
            const fetchButton = document.getElementById('fetchButton');
            fetchButton.addEventListener('click', () => {
                const ticker = document.getElementById('tickerInput').value;
                if(ticker){
                    alert(`Fetching data for: ${ticker}`);
                    console.log(`Fetching data for: ${ticker}`);
                } else {
                    alert("Please enter a ticker symbol.");
                }
            });
        });
    </script>

</body>
</html>